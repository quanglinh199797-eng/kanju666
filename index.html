import os

# ================= é…ç½®åŒºåŸŸ =================
# å¡«å†™ä½ å­˜æ”¾æµ·æŠ¥çš„æ–‡ä»¶å¤¹è·¯å¾„ï¼ˆå¦‚æœæ˜¯å½“å‰ç›®å½•å°±å†™ '.'ï¼‰
IMAGE_DIR = '.' 
# ç”Ÿæˆçš„ç½‘é¡µæ–‡ä»¶å
OUTPUT_FILE = 'index.html'
# ç½‘é¡µæ ‡é¢˜
PAGE_TITLE = "é™æ€èµ„æº API å…¼å®¹æ€§æµ‹è¯•åº“"
# ===========================================

def generate_poster_wall():
    # 1. è·å–æ–‡ä»¶å¤¹å†…æ‰€æœ‰çš„å›¾ç‰‡æ–‡ä»¶
    valid_extensions = ('.jpg', '.jpeg', '.png', '.webp', '.gif')
    images = [f for f in os.listdir(IMAGE_DIR) if f.lower().endswith(valid_extensions)]
    
    if not images:
        print("âŒ æœªåœ¨ç›®å½•ä¸­æ‰¾åˆ°å›¾ç‰‡æ–‡ä»¶ï¼Œè¯·æ£€æŸ¥è·¯å¾„ã€‚")
        return

    # 2. æ„å»º HTML å†…å®¹
    html_template = f"""<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{PAGE_TITLE}</title>
    <style>
        body {{ font-family: sans-serif; background: #f4f4f4; padding: 20px; text-align: center; }}
        h1 {{ color: #333; }}
        .disclaimer {{ background: #eee; padding: 10px; border-radius: 5px; font-size: 0.9em; color: #666; margin-bottom: 30px; }}
        .wall {{ display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; }}
        .card {{ background: #fff; padding: 10px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }}
        img {{ width: 180px; height: 260px; object-fit: cover; border-radius: 4px; display: block; }}
        .name {{ margin-top: 8px; font-size: 12px; color: #888; max-width: 180px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }}
    </style>
</head>
<body>
    <h1>{PAGE_TITLE}</h1>
    <div class="disclaimer">
        ğŸ›¡ï¸ <b>å…è´£å£°æ˜ï¼š</b>æœ¬é¡¹ç›®ä»…ç”¨äºå¼€æº CMS å‰ç«¯ UI åŠ è½½æ•ˆç‡åŠå…¼å®¹æ€§ç ”ç©¶ã€‚<br>
        æ‰€æœ‰æµ·æŠ¥ç´ æå‡é€šè¿‡ç¬¬ä¸‰æ–¹å…¬å¼€ API å®æ—¶è°ƒç”¨æµ‹è¯•ï¼Œä¸ä½œå•†ä¸šå­˜å‚¨ï¼Œç‰ˆæƒå½’åŸä½œè€…æ‰€æœ‰ã€‚
    </div>
    
    <div class="wall">
"""

    # 3. å¾ªç¯æ·»åŠ å›¾ç‰‡èŠ‚ç‚¹
    for img in images:
        html_template += f"""
        <div class="card">
            <img src="{img}" alt="{img}">
            <div class="name">{img}</div>
        </div>"""

    # 4. å°åº•
    html_template += """
    </div>
    <p style="margin-top: 50px; color: #aaa; font-size: 12px;">Generated by Python Auto-Gallery Script</p>
</body>
</html>"""

    # 5. å†™å…¥æ–‡ä»¶
    with open(OUTPUT_FILE, 'w', encoding='utf-8') as f:
        f.write(html_template)
    
    print(f"âœ… æˆåŠŸï¼å·²ç”Ÿæˆ {OUTPUT_FILE}ï¼ŒåŒ…å« {len(images)} å¼ æµ·æŠ¥ã€‚")

if __name__ == "__main__":
    generate_poster_wall()
